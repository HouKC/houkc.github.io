---
layout:     post
title:      树莓派部署Django项目
subtitle:   树莓派raspbian系统 + nginx + uwsgi + Django + MySQL，实现树莓派部署Django网站，并且同一局域网下的其他客户端可以正常访问。
date:       2019-11-26
author:     HouKC
header-img: img/post-bg-coffee.jpeg
catalog:    true
tags:
    - Python
    - 树莓派
    - nginx
    - uwsgi
    - Django
    - MySQL
---

## 前言
在本地写了一个Django + MySQL的网站小项目，又不想在本地运行这个网站，想要将其部署到服务器上，但是域名和服务器都要花钱。

正好手头有一个树莓派，于是就诞生了拿树莓派当做服务器的想法，至少在同一个局域网（WiFi）下，笔记本浏览器可以访问网站。
## 整体架构
## 版本信息
- 编程语言 Python：
- 数据库 MySQL：
- 后端框架 Django：
- wsgi服务器 uwsgi：
- web服务器 nginx：
## 步骤
#### 1. 环境配置
putty连接树莓派后，开始安装virtualenv虚拟环境，输入以下命令：
```
pip3 install virtualenv
```
安装完成后，在目录/home/pi/下创建文件夹www，以及在www文件夹下创建工程文件夹web（这个就是我的Django项目名），并创建生成环境，输入以下命令：
```
cd ~
mkdir www
cd www
mkdir web
cd web
python3 -m virtualenv --no-site-packages venv
```
激活环境，输入以下命令：
```
source venv/bin/activate
```
注意观察激活前后状态变化
```
pi@raspberrypi:~/www/web $ source venv/bin/activate
(venv) pi@raspberrypi:~/www/web $
```
退出环境，输入以下命令：
```
deactivate
```

#### 2. MySQL配置
输入以下命令安装MySQL：
```
sudo apt-get update
sudo apt-get install mysql-server mysql-client python-mysqldb
```
如果报错，需要依赖包mariadb-server-10.0，或者需要依赖包default-mysql-server，参考[树莓派安装MySQL](https://houkc.github.io/2019/11/28/piMysql/)进行配置安装。

#### 3. Django配置
激活虚拟环境：
```
cd ~/www/web
source venv/bin/activate
```
在本地找到cmd命令行里cd到Django项目路径下(我的是E:\workspace\python_workspace\project_web\web，web就是我的项目)，输入以下命令：
```
pip3 freeze > requirements.txt
```
这样本地环境下的所有python依赖包都被添加到requirements.txt文件中了，接下来只要把本地的整个项目（web目录下的所有文件夹和文件）移动到树莓派下即可。

使用filelliza软件，将项目移动到树莓派/home/pi/www/web下。
 ![转移django](https://raw.githubusercontent.com/HouKC/houkc.github.io/master/img/piDjango-move.jpg)
 移动后我的/home/pi/www/web目如下：
```
(venv) pi@raspberrypi:~/www/web $ ls
datashow     manage.py         static     venv
__init__.py  requirements.txt  templates  web
```
其中venv、manage.py、requirements.txt、web是肯定有的，因为web目录和manage.py文件是我创建项目时就产生的，venv是虚拟环境，requirements.txt是依赖包文件，
templates和static是存放前端文件的目录，init.py文件是python工程的标志，datashow是我的Django APP。

接着，输入以下命令来加载python依赖包：
```
pip3 install -r requirements.txt
```
接下来静静等待就完事了（要等好一会哈哈哈）。

完成后，输入以下命令查询一下mysql是否打开：
```
ps -ef|grep mysql
```
如果有结果说明开启着，否则输入以下命令开启：
```
sudo /etc/init.d/mysql start
# 重启的话是以下命令：
sudo /etc/init.d/mysql restart
```


#### 4. uwsgi配置
#### 5. nginx配置
## 后记
参考：

[树莓派部署django项目 | 树莓派小无相系列](https://www.jianshu.com/p/68164aa69261)

[如何将本地的Django项目部署到云服务器](https://blog.csdn.net/qq_30501975/article/details/80423547)

[树莓派3 之 安装Mysql服务](https://www.cnblogs.com/apanly/p/9061803.html)